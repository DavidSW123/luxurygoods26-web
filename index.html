<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Luxury Goods. Curated Elegance & Exquisite Craftsmanship. Relojería y joyería de lujo.">
    <title>Luxury Goods | Elegancia Curada</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>

    <header class="marble-header">
        <nav class="top-nav">
            <ul>
                <li><a href="#" class="active">Home</a></li>
                <li><a href="#">Shop</a></li>
                <li><a href="#">New Arrivals</a></li>
                <li><a href="#">Contact</a></li>
                
                <li id="menu-login"><a href="#" id="btn-open-login">Acceso</a></li>
                <li id="menu-admin" class="hidden"><a href="admin.html" class="admin-link">Panel Admin</a></li>
                <li id="menu-logout" class="hidden"><a href="#" id="btn-logout">Salir</a></li>
            </ul>
        </nav>
        
        <div class="logo-container">
            <img src="logo.png" alt="Luxury Goods Logo" class="main-logo">
            <p class="tagline">Curated Elegance, Exquisite Craftsmanship</p>
        </div>
    </header>

    <main class="white-section">
        <section class="featured-product">
            <div class="product-image-container">
                <img src="reloj.jpeg" alt="Reloj de lujo en caja de cuero Luxury Goods">
            </div>
            <div class="product-info-container">
                <div class="crown-icon-wrapper">
                    <img src="crown-icon.png" alt="Corona" class="crown-icon">
                </div>
                <h2 class="product-title">Classic Timeless Pieces</h2>
                <p class="product-description">Descubre la precisión de nuestra colección de relojería suiza. Piezas diseñadas para perdurar.</p>
            </div>
        </section>
    </main>

    <footer class="marble-footer">
        <div class="footer-content">
            <img src="logo.png" alt="Luxury Goods Logo Footer" class="footer-logo">
            <div class="contact-info">
                <p>Elegancia Curada, Artesanía Exquisita</p>
                <p>Contacto: info@luxurygoods.com</p>
            </div>
        </div>
        <p class="copyright">&copy; 2026 Luxury Goods. Todos los derechos reservados.</p>
    </footer>

    <div id="login-modal" class="hidden" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:1000; display:flex; justify-content:center; align-items:center;">
        <div style="background:#1E1E1E; padding:35px; border-radius:8px; border:1px solid rgba(197, 160, 89, 0.3); text-align:center; max-width: 400px; width: 90%; font-family:'Montserrat', sans-serif;">
            <h2 style="color:#C5A059; font-family:'Cinzel', serif; margin-bottom: 25px;">Acceso Exclusivo</h2>
            
            <button id="btn-google" style="background:white; color:black; padding:12px 20px; border:none; border-radius:4px; cursor:pointer; width:100%; margin-bottom:20px; font-family:'Montserrat', sans-serif; font-weight:600; display:flex; align-items:center; justify-content:center; gap:10px;">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" style="width:18px;" alt="Google">
                Continuar con Google
            </button>
            
            <p style="margin-bottom:20px; font-size:0.85rem; color:#888; text-transform:uppercase; letter-spacing:1px;">O con tu email</p>
            
            <input type="email" id="login-email" placeholder="Correo electrónico" style="width:100%; padding:12px; margin-bottom:12px; background:#2A2A2A; color:white; border:1px solid #444; border-radius:4px; box-sizing:border-box; font-family:'Montserrat', sans-serif;">
            <input type="password" id="login-pass" placeholder="Contraseña" style="width:100%; padding:12px; margin-bottom:25px; background:#2A2A2A; color:white; border:1px solid #444; border-radius:4px; box-sizing:border-box; font-family:'Montserrat', sans-serif;">
            
            <button id="btn-email-login" style="background:transparent; color:#C5A059; padding:12px 20px; border:1px solid #C5A059; cursor:pointer; width:100%; transition:all 0.3s; font-family:'Montserrat', sans-serif; font-weight:600; text-transform:uppercase;">Iniciar Sesión</button>
            
            <p id="btn-close-modal" style="margin-top:25px; color:#666; cursor:pointer; font-size:0.9rem; transition:color 0.3s;">Cerrar</p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
        // Añadimos GoogleAuthProvider y signInWithPopup
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAdWnW_eamYoki_qYd3huavNh5baxOJIRA",
            authDomain: "luxurygoods26.firebaseapp.com",
            projectId: "luxurygoods26",
            storageBucket: "luxurygoods26.firebasestorage.app",
            messagingSenderId: "603153460354",
            appId: "1:603153460354:web:97534032034721a8d4989b"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const googleProvider = new GoogleAuthProvider(); // Activamos el proveedor de Google

        // Elementos del DOM
        const menuLogin = document.getElementById('menu-login');
        const menuAdmin = document.getElementById('menu-admin');
        const menuLogout = document.getElementById('menu-logout');
        
        const loginModal = document.getElementById('login-modal');
        const btnOpenLogin = document.getElementById('btn-open-login');
        const btnCloseModal = document.getElementById('btn-close-modal');
        const btnLogout = document.getElementById('btn-logout');

        // LÓGICA DEL MODAL (Abrir y Cerrar)
        btnOpenLogin.addEventListener('click', (e) => {
            e.preventDefault();
            loginModal.classList.remove('hidden');
        });

        btnCloseModal.addEventListener('click', () => {
            loginModal.classList.add('hidden');
        });

        // ESCUCHADOR DE SESIÓN (El portero)
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // Hay sesión: Cambiamos el menú
                menuLogin.classList.add('hidden');
                menuLogout.classList.remove('hidden');

                // Comprobamos si el usuario actual es Admin
                const docRef = doc(db, "usuarios", user.uid);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists() && docSnap.data().rol === "admin") {
                    menuAdmin.classList.remove('hidden');
                } else {
                    menuAdmin.classList.add('hidden');
                }
            } else {
                // No hay sesión
                menuLogin.classList.remove('hidden');
                menuAdmin.classList.add('hidden');
                menuLogout.classList.add('hidden');
            }
        });

        // LOGIN CON EMAIL
        document.getElementById('btn-email-login').addEventListener('click', () => {
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-pass').value;
            
            if(!email || !pass) {
                alert("Por favor, rellena ambos campos.");
                return;
            }

            signInWithEmailAndPassword(auth, email, pass)
                .then(() => {
                    loginModal.classList.add('hidden');
                    // Borramos los campos para que quede limpio
                    document.getElementById('login-email').value = "";
                    document.getElementById('login-pass').value = "";
                })
                .catch((error) => alert("Error: Verifica tu correo o contraseña."));
        });

        // LOGIN CON GOOGLE
        document.getElementById('btn-google').addEventListener('click', () => {
            signInWithPopup(auth, googleProvider)
                .then((result) => {
                    loginModal.classList.add('hidden');
                })
                .catch((error) => alert("Error con Google: " + error.message));
        });

        // FUNCIÓN SALIR (Arreglada)
        btnLogout.addEventListener('click', (e) => {
            e.preventDefault(); // Evita que la página salte
            signOut(auth).then(() => {
                // Al salir, recargamos la web de forma segura
                window.location.href = window.location.pathname; 
            }).catch((error) => {
                console.error("Error al salir:", error);
            });
        });
    </script>
</body>
</html>